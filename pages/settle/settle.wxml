<!--pages/settle/settle.wxml420028-->
<view class='wrap'></view>

<view class='settle_address'>
    <navigator wx:if="{{!receiverInfo}}" url='/pages/settlereceiverlist/settlereceiverlist' class='un_settle_address'>
        <image src='../images/location-2@3x.png' mode='aspectFit' class='location_icon'></image>
        <text>新增地址</text>
    </navigator>
    <navigator wx:if="{{receiverInfo}}" url='/pages/settlereceiverlist/settlereceiverlist' class='settle_address_info'>
        <view class='settle_address_left'>
            <view class='settle_address_top'>
                <view class='settle_address_top_receiver_name'>
                    <view class='settle_address_title'>收货人：</view>
                    <view>{{receiverInfo.name}}</view>
                </view>
                <text>{{receiverInfo.phoneNum}}</text>
            </view>
            <view class='settle_address_detail'>
                <image src='../images/location-2@3x.png' mode='aspectFit' class='location_icon'></image>
                <view class='settle_address_title'>收货地址：</view>
                <view class='address'>
                    <!-- <text wx:if="{{receiverInfo.addressTagName}}">{{receiverInfo.addressTagName}}</text> -->
                    <text class='address_full_address'>{{receiverInfo.locationInfo.receiveAddress}}</text>
                </view>
            </view>
        </view>
        <image src='../images/me-arrow@2x.png' mode='aspectFit' class='reset_address_icon'></image>
    </navigator>
</view>
<image mode='left' src='../images/line.png' class='address_line'></image>


<view class='settle_product_list'>
    <view wx:for="{{settleProductList}}" wx:for-item="settleProduct" wx:for-index="i" wx:key="i" class='settle_product'>
        <view class='product_left'>
            <image src='{{settleProduct.imageUrl}}' mode='aspectFit' class='product_img'></image>
            <view class='product_info'>
                <view class='product_name'>
                    <text>{{settleProduct.name}}</text>
                    <text class='product_type'>{{settleProduct.productType}}</text>
                </view>
                <text class='product_volume'>{{settleProduct.volume}}</text>
                <view class='product_money'>
                    <text>￥</text>
                    <text class='product_money_price'>{{settleProduct.currentPrice /100}}</text>
                </view>
            </view>
        </view>
        <view class='count_ctrl'>
            <view class='product_count_item' bindtap='bindRemoveProduct' data-shop-id='{{settleProduct.shopId}}'
                  data-product-id='{{settleProduct.productItemId}}'>-
            </view>
            <view class='product_count_item product_count'>{{settleProduct.selectCount}}</view>
            <view class='product_count_item' bindtap='bindAddProduct' data-shop-id='{{settleProduct.shopId}}'
                  data-product-id='{{settleProduct.productItemId}}'>+
            </view>
        </view>
    </view>
</view>
<view class='settle_product_total_price'>
    <text>商品金额：</text>
    <view class='settle_product_total_price_unit'>￥{{totalProductPrice /100}}</view>
</view>
<view wx:if="{{hasBucketList}}" class="bucket_list">
    <view class="my_bucket_list_button" bindtap="bindShowBucketList">
        <text class="my_bucket_text">我的空桶</text>
    </view>

    <view class='settle_product_list'>
        <view wx:for="{{bucketProductList}}" wx:for-item="bucketProduct" wx:for-index="i" wx:key="i" class='settle_product'>
            <view class='product_left'>
                <image src='{{bucketProduct.imageUrl}}' mode='aspectFit' class='product_img'></image>
                <view class='product_info'>
                    <view class='product_name'>
                        <text>{{bucketProduct.name}}</text>
                        <text class='product_type'>{{bucketProduct.productType}}</text>
                    </view>
                    <text class='product_volume'>{{bucketProduct.volume}}</text>
                    <view class='product_money'>
                        <text>￥</text>
                        <text class='product_money_price'>{{bucketProduct.currentPrice /100}}</text>
                    </view>
                </view>
            </view>
        </view>
    </view>
</view>




<view class='product_list_info'>
    <view class='use_ticket_counts' bindtap='bindShowWaterTicketList'>
        <view class='use_ticket_counts_title'>
            <text>水票抵用：</text>
            <text class='settle_total_can_use_count'>{{waterTicketTotalCount}}张可用</text>
        </view>
        <view class='use_ticket_counts_info'>
            <text>-￥</text>
            <text>{{waterTicketTotalUsedMoney/100}}</text>
            <image src='../images/me-arrow@2x.png' mode='aspectFit' class='arrow_right'></image>
        </view>
    </view>
    <view class='use_ticket_counts' bindtap='bindShowXbChange'>
        <view class='use_ticket_counts_title'>
            <text>喜币抵用：</text>
            <text class='settle_total_can_use_count'>{{totalXb}}喜币可用</text>
        </view>
        <view class='use_ticket_counts_info'>
            <text>-￥</text>
            <text>{{xbTotalUse / 10 }}</text>
            <image src='../images/me-arrow@2x.png' mode='aspectFit' class='arrow_right'></image>
        </view>
    </view>
    <view class='mopoints'>
        <view class='mopoints_title'>
            <text>代金券抵用：</text>
            <text class='settle_total_can_use_count'>0张可用</text>
        </view>
        <view class='mopoints_info'>
            <text>-0张</text>
        </view>
    </view>
    <view class='delivery_costs'>
        <text class='delivery_costs_title'>快递费用：</text>
        <view class='delivery_costs_info'>
            <text>+0.00元</text>
        </view>
    </view>
</view>
<view class='settle_bottom'>
    <view class='settle_bottom_left'>
        <text>共{{totalProductCount}}件</text>
        <text class='settle_bottom_pay_title'>实付款：</text>
        <text class='settle_bottom_pay_unit'>￥</text>
        <text class='settle_bottom_pay_rmb'>{{totalPayRmb /100}}</text>
    </view>
    <button open-type="getUserInfo" lang="zh_CN" bindgetuserinfo='bindCreateOrder' class='settle_toPay'>提交订单</button>
</view>


<view class='xb_change_wrap' wx:if="{{isShowChangeXb}}"></view>
<view class='change_xb' wx:if="{{isShowChangeXb}}">
    <view class='use_xb_title'>
        <text>喜币</text>
    </view>
    <view class='change_xb_body'>

        <text class='change_xb_title'>使用喜币</text>

        <view class='use_ticket_counts_info'>
            <view class='count_ctrl'>
                <view class='product_count_item' bindtap='bindReduceXb'>-</view>
                <view class='product_count_item product_count'>{{xbTotalUse}}</view>
                <view class='product_count_item' bindtap='bindIncreaseXb'>+</view>
            </view>
        </view>
    </view>
    <view class='confirm_change_xb' bindtap='bindCloseXbChange'>确定</view>
</view>
<view class='xb_change_wrap' wx:if="{{isShowBucketList}}"></view>
<view class='select_bucket' wx:if="{{isShowBucketList}}">
    <view class='use_xb_title'>
        <text>选择空桶</text>
        <view class="close_button" bindtap="bindCloseBucketList">
            <image src='../images/icon_dingdan_quxiao@2x.png' mode="aspectFit" class="bucket_list_close_img"></image>
        </view>
    </view>
    <view class='change_shopping_cart_bucket_body'>

        <view wx:for="{{shoppingCartProductList}}" wx:for-item="shoppingCartProduct" wx:for-index="j" wx:key="j"
              class='shopping_cart_product'>
            <view class='product_selected' bindtap='bindSelectedProductItem'
                  data-shop-shopping-cart-id='{{shoppingCartProduct.shopInfo.shopId}}'
                  data-product-id='{{shoppingCartProduct.productItemId}}'>
                <image wx:if="{{shoppingCartProduct.selected}}" src='../images/shoppingcart_choose_s.png'
                       class="selected_icon"></image>
                <image wx:if="{{!shoppingCartProduct.selected}}" src='../images/shoppingcart_choose_n.png'
                       class="selected_icon"></image>
            </view>
            <view class='shopping_cart_right'>
                <view class='shop_info'>
                    <image src='{{shoppingCartProduct.imageUrl}}' mode='aspectFit'
                           class='shopping_cart_product_img'></image>
                    <view class='shopping_cart_product_info'>
                        <view class='shopping_cart_product_name'>{{shoppingCartProduct.name}}</view>
                        <view class='shopping_cart_product_volume'>{{shoppingCartProduct.volume}}</view>
                        <view class="shopping_cart_product_price">
                            <text class='shopping_cart_product_price_unit'>￥</text>
                            <text>{{shoppingCartProduct.currentPrice / 100}}</text>
                        </view>
                    </view>
                </view>
                <view class='shopping_cart_product_count_ctrl'>
                    <view class='shopping_cart_product_count_item' bindtap='bindRemoveShoppingCartProduct'
                          data-shop-id='{{shoppingCartProduct.shopInfo.shopId}}'
                          data-product-id='{{shoppingCartProduct.productItemId}}'>-
                    </view>
                    <view class='shopping_cart_product_count_item shopping_cart_product_count'>
                        {{shoppingCartProduct.selectCount}}
                    </view>
                    <view class='shopping_cart_product_count_item' bindtap='bindAddShoppingCartProduct'
                          data-shop-id='{{shoppingCartProduct.shopInfo.shopId}}'
                          data-product-id='{{shoppingCartProduct.productItemId}}'>+
                    </view>
                </view>
            </view>

        </view>
    </view>
    <view class='confirm_change_xb' bindtap="bindCloseBucketList">确定</view>
</view>

<view class='xb_change_wrap' wx:if="{{isShowWaterTicketList}}"></view>
<view class='water_ticket_list' wx:if="{{isShowWaterTicketList}}">
    <view class='use_xb_title'>
        <text>使用水票</text>
        <view class="close_button" bindtap="bindCloseWaterTicketList">
            <image src='../images/icon_dingdan_quxiao@2x.png' mode="aspectFit" class="bucket_list_close_img"></image>
        </view>
    </view>
    <view class='use_water_ticket_status'>
      <text>可使用水票</text>
      <text>不可使用水票</text>
    </view>
    <view wx:for="{{useWaterTicketList}}" wx:for-item="waterTicket" wx:for-index="i" wx:key="i" class='water_ticket'>
      <view class='water_ticket_top'>
        <image src='../images/img_ticket@2x.png' mode='aspectFit' class="water_ticket_img"></image>    
        <view class='water_ticket_name'>
          <text>{{waterTicket.name}}</text>
        </view>
        <!-- <text class='water_ticket_smallName'>{{waterTicket.volume}}</text>  -->
        <view class='water_ticket_right'>
          <text>{{waterTicket.totalCount}}</text>
          <text class='water_ticket_unit'>张</text>
        </view>      
      </view>

      <view class='water_ticket_bottom'>
        <text>使用水票</text>
        <view class='count_ctrl'>
          <view class='water_ticket_count_item' bindtap='bindReduceSelectUseCount' data-ticket-id='{{waterTicket.ticketId}}'>-</view>
          <view class='water_ticket_count_item water_ticket_count'>{{waterTicket.selectUseCount}}</view>
          <view class='water_ticket_count_item' bindtap='bindIncreaseSelectUseCount' data-ticket-id='{{waterTicket.ticketId}}'>+</view>
        </view>
      </view> 
    </view>
    <view class='confirm_change_xb' bindtap='bindCloseWaterTicketList'>确定</view>
</view>


